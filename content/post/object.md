---
title: "对象的内存结构"
date: 2020-03-25T23:37:40+08:00
categories: ["Java"]
tags: ["Java"]
---
"`Java`中对象的内存结构是怎样的呢？"
<!--more-->

对象在内存中存储的布局可以分为3块区域：对象头`（Header）`、实例数据`（Instance Data）`和对齐填充`（Padding）`。

## 1.对象头的结构

`HotSpot`虚拟机的对象头包括两部分信息，第一部分用于存储对象自身的运行时数据，如哈希码、GC分代年龄、锁状态标志、线程持有的锁、偏向线程ID、偏向时间戳等，这部分数据的长度在32位和64位的虚拟机中分别为32bit和64bit，官方称它为`“Mark Word”`；对象头的另外一部分是类型指针，即对象指向它的类元数据的指针，虚拟机通过这个指针来确定这个对象是哪个类的实例。

## 2.实例数据

实例数据部分是对象真正存储的有效信息，也既是我们在程序代码里所定义的各种类型的字段内容，无论是从父类继承下来的，还是在子类中定义的都需要记录下来。

## 3.对其填充

对齐填充并不是必然存在的，也没有特别的含义，它仅仅起着占位符的作用。由于`HotSpot VM`的自动内存管理系统要求对象起始地址必须是8字节的整数倍，换句话说就是对象的大小必须是8字节的整数倍。对象头正好是8字节的倍数，因此当对象实例数据部分没有对齐的话，就需要通过对齐填充来补全。

